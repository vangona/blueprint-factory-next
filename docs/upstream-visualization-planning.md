# 상위 노드 하이라이트 기능 기획서

## 1. 기능 개요

### 목적
현재 작업(하위 노드)이 어떤 상위 목표를 위한 것인지 시각적으로 명확하게 보여주어 사용자가 목적 의식을 가지고 행동할 수 있도록 지원

### 핵심 가치 제안
- **목적 명확화**: 현재 하는 일의 최종 목표 확인
- **동기 부여**: 작은 행동이 큰 목표에 기여한다는 인식
- **우선순위 판단**: 상위 목표와의 연결성으로 중요도 파악

## 2. Best Practice 분석

### 2.1 Mind Mapping Software (Xmind, MindMeister)
- **계층적 구조 시각화**: 부모-자식 관계를 트리 구조로 명확히 표현
- **선택적 하이라이트**: 노드 선택 시 관련 경로만 강조 표시
- **색상 기반 구분**: 단계별 다른 색상으로 계층 구분

### 2.2 Dependency Visualization Tools
- **경로 추적**: 선택된 노드에서 루트까지의 전체 경로 표시
- **상태 기반 색상**: 연결 상태에 따른 시각적 피드백 (성공/실패/진행중)
- **점진적 공개**: 필요한 정보만 단계적으로 표시

### 2.3 React Flow Best Practices
- **getIncomers() 활용**: 상위 노드 탐지
- **조건부 스타일링**: 선택 상태에 따른 동적 스타일 적용
- **부드러운 애니메이션**: 시각적 전환 효과

## 3. 기능 명세서

### 3.1 기본 동작
1. **노드 클릭**: 사용자가 임의의 노드를 클릭
2. **경로 탐지**: 클릭된 노드에서 시작하여 모든 상위 노드들을 탐지
3. **시각적 하이라이트**: 탐지된 상위 노드들과 연결 엣지를 하이라이트
4. **경로 표시**: 선택된 노드에서 최상위 목표까지의 전체 경로 시각화

### 3.2 시각적 디자인

#### 하이라이트 스타일
```css
/* 선택된 노드 */
.node-selected {
  border: 3px solid #3B82F6;
  box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
  transform: scale(1.05);
}

/* 상위 노드들 */
.node-upstream {
  border: 2px solid #10B981;
  background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.2));
  box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
}

/* 연결 엣지 */
.edge-highlighted {
  stroke: #3B82F6;
  stroke-width: 3px;
  stroke-dasharray: 5,5;
  animation: dash 1s linear infinite;
}

/* 비활성 노드/엣지 */
.node-dimmed, .edge-dimmed {
  opacity: 0.3;
  transition: opacity 0.3s ease;
}
```

#### 색상 체계
- **선택된 노드**: 파란색 (#3B82F6) - 현재 포커스
- **상위 노드**: 초록색 (#10B981) - 목표/목적
- **연결 엣지**: 파란색 점선 - 관계 표시
- **비활성 요소**: 30% 투명도 - 관련 없는 요소

### 3.3 계층별 차별화

#### Level 1: 직접 상위 (Parent)
- 가장 진한 초록색
- 두꺼운 테두리 (3px)
- 살짝 확대 효과

#### Level 2: 간접 상위 (Grandparent)
- 중간 톤 초록색
- 중간 테두리 (2px)
- 기본 크기

#### Level 3+: 원거리 상위
- 연한 초록색
- 얇은 테두리 (1px)
- 기본 크기

### 3.4 인터랙션 패턴

#### 호버 효과
```typescript
// 호버 시 미리보기
onNodeMouseEnter: (node) => {
  showUpstreamPreview(node.id, { opacity: 0.6, duration: 200 });
}

onNodeMouseLeave: (node) => {
  hideUpstreamPreview({ duration: 200 });
}
```

#### 클릭 동작
```typescript
// 클릭 시 완전 하이라이트
onNodeClick: (node) => {
  if (selectedNode === node.id) {
    clearHighlight(); // 동일 노드 재클릭 시 해제
  } else {
    highlightUpstreamPath(node.id);
    showPathInfo(node.id); // 경로 정보 표시
  }
}
```

## 4. 구현 단계

### Phase 1: 기본 하이라이트 (1주)
- [ ] React Flow getIncomers() 활용한 상위 노드 탐지
- [ ] 기본 하이라이트 스타일 적용
- [ ] 클릭 이벤트 처리

### Phase 2: 고급 시각화 (1주)
- [ ] 계층별 차별화된 스타일링
- [ ] 애니메이션 효과 추가
- [ ] 호버 미리보기 기능

### Phase 3: 사용성 개선 (3일)
- [ ] 경로 정보 툴팁/패널
- [ ] 키보드 단축키 지원
- [ ] 성능 최적화

### Phase 4: 고급 기능 (1주)
- [ ] 다중 선택 지원
- [ ] 경로 저장/즐겨찾기
- [ ] 목표 달성률 연동 표시

## 5. 사용자 시나리오

### 시나리오 1: 일일 업무 의미 파악
```
사용자: "오늘 SQLD 시험 공부를 하는데 이게 왜 중요한지 모르겠어"
액션: SQLD 취득 노드 클릭
결과: 개발자 취업 → 월 2000만원 달성 경로가 하이라이트됨
효과: 현재 공부가 최종 목표에 어떻게 기여하는지 명확히 인식
```

### 시나리오 2: 우선순위 판단
```
사용자: "여러 할 일 중 어떤 것이 더 중요한지 판단하기 어려워"
액션: 각 할 일 노드를 순차적으로 클릭
결과: 상위 목표와의 연결 강도 및 계층 수준을 비교
효과: 최종 목표에 더 직접적으로 연결된 업무의 우선순위 상승
```

### 시나리오 3: 동기 부여
```
사용자: "작은 일들이 의미없게 느껴져서 포기하고 싶어"
액션: 작은 할 일 노드 클릭
결과: 해당 업무가 큰 목표에 어떻게 기여하는지 전체 경로 표시
효과: 작은 행동도 큰 목표의 일부라는 인식으로 동기 부여
```

## 6. 기술적 고려사항

### 6.1 성능 최적화
- 노드 수가 많을 때의 탐색 알고리즘 효율성
- 리렌더링 최소화를 위한 메모이제이션
- 큰 그래프에서의 시각적 성능

### 6.2 사용성
- 직관적인 시각적 언어
- 접근성 고려 (색맹, 키보드 접근)
- 모바일 환경에서의 터치 인터랙션

### 6.3 확장성
- 다양한 노드 타입 지원
- 사용자 정의 하이라이트 규칙
- 다른 시각화 모드와의 통합

## 7. 성공 지표

### 정량적 지표
- 노드 클릭 후 상위 목표 조회율
- 하이라이트 기능 사용 빈도
- 목표 달성률 개선 정도

### 정성적 지표
- 사용자 만족도 조사
- 목적 의식 개선 피드백
- 동기 부여 효과 평가

## 8. 리스크 및 대응방안

### 리스크 1: 시각적 복잡성
- **문제**: 너무 많은 하이라이트로 인한 혼란
- **대응**: 점진적 공개, 레벨별 토글 기능

### 리스크 2: 성능 저하
- **문제**: 큰 그래프에서의 느린 응답
- **대응**: 가상화, 지연 로딩, 캐싱

### 리스크 3: 사용자 학습 곡선
- **문제**: 새로운 인터랙션 패턴 적응
- **대응**: 온보딩 튜토리얼, 도움말 제공

이 기획서를 바탕으로 단계적으로 구현하여 사용자가 현재 행동의 의미와 목적을 명확히 이해할 수 있도록 지원하겠습니다.